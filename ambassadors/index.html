<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ambassador Registration - Alex AI Insurtech</title>
    <link rel="icon" type="image/png" href="../assets/img/favicon.ico">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="../css/ambassador.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <script>
        // Esta variable es la que busca tu ambassador.js
        const SUPABASE_URL = 'https://pddukinvrrmibnxfunuw.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBkZHVraW52cnJtaWJueGZ1bnV3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDk2NjY4NzQsImV4cCI6MjAyNTI0Mjg3NH0.U7J_sWc-Fm-X4d5y2Z8n2b2x3c4v5b6n7m8';
        window.supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    </script>
</head>
<body>

    <header class="site-header">
        <div class="header-content">
            <a href="https://alexai.cloud/" class="logo-link" target="_blank">
                <img src="../assets/img/Logo-alexai-main.png" alt="Alex AI Logo" class="logo-img">
            </a>
            <nav class="header-nav">
                <a href="https://alexai.cloud/" target="_blank">Home</a>
                <a href="https://rater.alexai.cloud/quote-tool" target="_blank">Quote Auto</a>
                <a href="https://alexai.cloud/contact-us" target="_blank">Contact</a>
            </nav>
        </div>
    </header>

    <div class="layout-container">

        <div class="main-header">
            <div class="title-sticker">
                <h1>Alex AI <span>Ambassador</span></h1>
                <span class="title-subtitle">Official Program</span>
            </div>
        </div>

        <div class="sketch-card">
            <form id="registration-form" novalidate>
                
                <div id="step-1" class="form-step active" data-step="1">
                    <h1>Tell us where to send the money.</h1>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="user-name">First Name*</label>
                            <input type="text" id="user-name" required placeholder="e.g. Jonathan">
                        </div>
                        <div class="form-group">
                            <label for="user-lastname">Last Name*</label>
                            <input type="text" id="user-lastname" required placeholder="e.g. Smith">
                        </div>
                        <div class="form-group">
                            <label for="user-email">Email Address*</label>
                            <input type="email" id="user-email" required placeholder="name@example.com">
                        </div>
                        <div class="form-group">
                            <label for="user-phone">Phone Number*</label>
                            <input type="tel" id="user-phone" required placeholder="(555) 123-4567">
                        </div>
                    </div>
                    
                    <p id="step1-error" class="error-message hidden"></p>
                    
                    <div class="form-navigation">
                        <button type="button" id="btn-step1-next" class="button-primary">
                            Next Step <i class="fa-solid fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <div id="step-2" class="form-step hidden" data-step="2">
                    
                    <div id="visual-part-paypal">
                        <h1>Wallet Setup</h1>
                        
                        <div class="paypal-box">
                            <i class="fa-brands fa-paypal paypal-icon-large"></i>
                            
                            <h3 style="margin:0 0 10px 0; color:var(--alex-ink);">Connect Payout Method</h3>
                            <p style="margin-bottom:20px; font-weight:500;">We use Paypal to ensure you get paid instantly and securely.</p>
                            
                            <a href="https://www.paypal.com/paypalme/" target="_blank" class="btn-paypal">
                                <i class="fa-solid fa-link"></i> 
                                <span>Connect PayPal Wallet</span>
                            </a>
                            
                            <p class="text-small" style="font-size:0.75rem; margin-top:20px; color:#64748B; background:rgba(255,255,255,0.7); display:inline-block; padding:5px 10px; border-radius:5px;">
                                <i class="fa-solid fa-lock"></i> Secure connection. Requires W-9 tax info.
                            </p>
                        </div>
                        
                        <div class="form-navigation" style="justify-content: space-between;">
                             <button type="button" class="button-secondary" id="visual-back-step1">Back</button>
                             <button type="button" class="button-primary" onclick="showQuizIntro()">
                                Continue <i class="fa-solid fa-arrow-right"></i>
                             </button>
                        </div>
                    </div>

                    <div id="visual-part-quiz-intro" class="hidden">
                        <h1>The quick certification.</h1>
                        <p>As an ambassador, you represent our brand. It's vital that you understand the rules of transparency.</p>
                        
                        <div style="background:#EFF6FF; padding:15px; border-radius:12px; border: 2px solid #BFDBFE; margin: 20px 0;">
                            <div style="display:flex; gap:10px; align-items:center; color:#1E40AF; font-weight:700;">
                                <i class="fa-solid fa-graduation-cap"></i> Requirement:
                            </div>
                            <p style="margin:5px 0 0 0; color:#1E40AF;">You need 100% to pass. Unlimited attempts allowed.</p>
                        </div>

                        <div class="form-navigation">
                            <button type="button" class="button-secondary" onclick="showPaypal()">Back</button>
                            <button type="button" id="btn-step2-next" class="button-primary generate-btn">
                                Start Certification
                            </button>
                        </div>
                    </div>
                    
                    <button type="button" id="btn-step2-back" class="hidden"></button>
                </div>

                <div id="step-3" class="form-step hidden" data-step="3">
                    <h1>Certification Quiz</h1>
                    
                    <div class="quiz-container">
                        
                        <div class="form-group quiz-question">
                            <label>When do you earn your $25 reward?</label>
                            <div class="quiz-options">
                                <label class="quiz-option"><input type="radio" id="q1-a" name="q1" value="A"> A) When someone clicks my link.</label>
                                <label class="quiz-option"><input type="radio" id="q1-b" name="q1" value="B"> B) When someone requests a quote.</label>
                                <label class="quiz-option"><input type="radio" id="q1-c" name="q1" value="C" required> C) When my referral pays their first month's policy.</label>
                            </div>
                        </div>

                        <div class="form-group quiz-question">
                            <label>A friend asks what the policy covers. What do you do?</label>
                            <div class="quiz-options">
                                <label class="quiz-option"><input type="radio" id="q2-a" name="q2" value="A"> A) I explain the coverages as best as I can.</label>
                                <label class="quiz-option"><input type="radio" id="q2-b" name="q2" value="B" required> B) I tell them I'm not an agent, but the Alex AI team will explain everything when they use my link.</label>
                            </div>
                        </div>

                        <div class="form-group quiz-question">
                            <label>Can you refer yourself or your spouse to earn the reward?</label>
                            <div class="quiz-options">
                                <label class="quiz-option"><input type="radio" id="q3-a" name="q3" value="A"> A) Yes, all sales count.</label>
                                <label class="quiz-option"><input type="radio" id="q3-b" name="q3" value="B" required> B) No, the program is only for attracting new customers.</label>
                            </div>
                        </div>

                        <div class="form-group quiz-question">
                            <label>What is the correct way to promote your link?</label>
                            <div class="quiz-options">
                                <label class="quiz-option"><input type="radio" id="q4-a" name="q4" value="A"> A) Sending 500 mass (spam) emails to strangers.</label>
                                <label class="quiz-option"><input type="radio" id="q4-b" name="q4" value="B" required> B) Sharing it authentically with friends, family, or on my social media.</label>
                            </div>
                        </div>

                        <div class="form-group quiz-question">
                            <label>Can you promise someone will get "financial freedom" or "replace their income" with this program?</label>
                            <div class="quiz-options">
                                <label class="quiz-option"><input type="radio" id="q5-a" name="q5" value="A"> A) Yes, if they refer a lot of people.</label>
                                <label class="quiz-option"><input type="radio" id="q5-b" name="q5" value="B" required> B) No, that's a misleading income claim and is prohibited.</label>
                            </div>
                        </div>

                    </div> <p id="quiz-error" class="error-message hidden"></p>
                    
                    <div class="form-navigation">
                        <button type="button" id="btn-step3-back" class="button-secondary">Back</button>
                        
                        <button type="submit" id="quiz-submit-btn" class="button-primary generate-btn">
                            <span class="btn-text">Submit Answers</span>
                            <span class="loader hidden"></span>
                        </button>
                    </div>
                </div>
                
                <div id="step-4" class="form-step hidden" data-step="4">
                    <h1 style="color:var(--alex-blue);">Congratulations, <span id="user-name-final">Ambassador</span>!</h1>
                    <p>Your account is ready. Please activate it below.</p>
                    
                    <a href="https://rater.alexai.cloud/login" class="button-primary" style="display:block; text-align:center; text-decoration:none; margin-top:20px;">
                        Activate My Account
                    </a>
                    
                    <hr class="form-divider">
                    <div class="tips-section">
                        <h3>How to Share:</h3>
                        <div class="template-box" style="background:#F1F5F9; padding:15px; border-radius:10px;">
                            <strong>WhatsApp:</strong> "Hey! Found Alex AI for insurance. Transparent and cheap. Use my link: [Your Link]"
                        </div>
                    </div>
                </div>

            </form>
        </div>

        <aside class="sidebar-column">
            
            <div class="taped-paper">
                <div class="tape-top"></div>
                <div class="widget-title">YOUR PROGRESS</div>
                <ul class="progress-track" id="progress-list">
                    <li id="prog-1" class="active"><i class="fa-regular fa-circle-dot"></i> Personal Info</li>
                    <li id="prog-2"><i class="fa-regular fa-circle"></i> Wallet Setup</li>
                    <li id="prog-3"><i class="fa-regular fa-circle"></i> Certification</li>
                    <li id="prog-4"><i class="fa-regular fa-circle"></i> Activation</li>
                </ul>
            </div>

            <div class="taped-paper" style="transform: rotate(-1deg);">
                <div class="tape-top"></div>
                <div class="widget-title">HIGHLIGHTS</div>
                <div style="display:flex; gap:10px; margin-bottom:12px; font-size:0.9rem; color:#475569;">
                    <i class="fa-solid fa-check-circle" style="color:#10B981; margin-top:3px;"></i> 
                    <span><strong>$25 Per Referral</strong><br>Earn everytime someone buys.</span>
                </div>
                <div style="display:flex; gap:10px; font-size:0.9rem; color:#475569;">
                    <i class="fa-solid fa-check-circle" style="color:#10B981; margin-top:3px;"></i> 
                    <span><strong>Unlimited Cap</strong><br>No limit to your earnings.</span>
                </div>
            </div>

            <div class="note-widget">
                <div class="push-pin"></div>
                <h4 style="margin:0 0 10px 0; color:#92400E; font-size:1.1rem;">ðŸ’¡ Pro Tip:</h4>
                <p style="font-size:0.95rem; color:#92400E; margin:0; line-height:1.5;">
                    <strong>Use your inner circle.</strong><br>
                    Your first 5 sales ($125) usually come from family & friends who already trust you.
                </p>
            </div>

        </aside>

    </div>

    <div id="success-modal" class="modal-overlay hidden">
        <div class="modal-content" style="background:white; padding:30px; border-radius:20px; text-align:center; position:relative; max-width:400px; border:3px solid var(--alex-ink);">
            <button id="modal-close-btn" style="position:absolute; top:10px; right:15px; background:none; border:none; font-size:2rem; cursor:pointer;">&times;</button>
            <i class="fa-solid fa-certificate" style="font-size:4rem; color:#F59E0B; margin-bottom:20px;"></i>
            <h2 style="color:#10B981; margin:0;">Complete!</h2>
            <p>Your certificate is ready.</p>
        </div>
    </div>

    <script src="../js/ambassador.js"></script>

    <script>
        // 1. Manejo visual de pantallas internas
        function showQuizIntro() {
            document.getElementById('visual-part-paypal').classList.add('hidden');
            document.getElementById('visual-part-quiz-intro').classList.remove('hidden');
        }
        function showPaypal() {
            document.getElementById('visual-part-quiz-intro').classList.add('hidden');
            document.getElementById('visual-part-paypal').classList.remove('hidden');
        }

        // BotÃ³n Back visual del paso 2 (Dispara lÃ³gica de ir al paso 1)
        document.getElementById('visual-back-step1').addEventListener('click', function() {
            // Como tu JS usa 'showStep', podemos simular click en el back oculto si existiera,
            // o simplemente forzar la vista:
            document.getElementById('step-2').classList.add('hidden');
            document.getElementById('step-1').classList.remove('hidden');
            document.getElementById('step-1').classList.add('active');
            updateVisualProgress(1);
        });

        // 2. Control de Barra de Progreso
        function updateVisualProgress(step) {
            for(let i=1; i<=4; i++) {
                const li = document.getElementById(`prog-${i}`);
                if(!li) continue;
                const icon = li.querySelector('i');
                li.className = ''; 
                icon.className = 'fa-regular fa-circle';
                
                if(i < step) {
                    li.classList.add('completed');
                    icon.className = 'fa-solid fa-circle-check';
                } else if(i === step) {
                    li.classList.add('active');
                    icon.className = 'fa-regular fa-circle-dot';
                }
            }
        }

        // 3. ANIMACIÃ“N SHAKE (Antes de que tu JS valide)
        document.getElementById('btn-step1-next').addEventListener('mousedown', function() {
            const inputs = document.querySelectorAll('#step-1 input[required]');
            inputs.forEach(input => {
                if(!input.value.trim()) {
                    input.classList.add('input-error'); 
                    setTimeout(() => input.classList.remove('input-error'), 500);
                }
            });
        });

        // 4. Observador: Escucha a tu ambassador.js cambiar las clases
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((m) => {
                if (m.type === 'attributes' && m.attributeName === 'class') {
                    const target = m.target;
                    // Si el div es visible (active o no hidden)
                    if (target.classList.contains('active') || !target.classList.contains('hidden')) {
                        const stepStr = target.getAttribute('data-step');
                        if(stepStr) {
                            const step = parseInt(stepStr);
                            updateVisualProgress(step);
                            // Resetear vista interna de paso 2 si volvemos a Ã©l
                            if(step === 2) showPaypal(); 
                        }
                    }
                }
            });
        });
        document.querySelectorAll('.form-step').forEach(step => observer.observe(step, { attributes: true }));

        // Init
        updateVisualProgress(1);
    </script>
</body>
</html>